package com.lucifaer.jokerframework.core.mode;

import com.lucifaer.jokerframework.data.ExploitDataModel.JmxDataModel;
import com.lucifaer.jokerframework.modules.Payload;
import com.lucifaer.jokerframework.modules.payloads.jmx.JmxCommand;
import org.junit.Test;

import java.util.HashMap;
import java.util.Map;

import static org.junit.Assert.*;

public class ExploitModeTest {
    @Test
    public void testInitModel() throws Exception {
        Map<String, String> testOptions = new HashMap<>();
        testOptions.put("exploitName", "jmx");
        testOptions.put("exploitModeName", "command");
        testOptions.put("targetUrl", "127.0.0.1:23333");
        testOptions.put("installUrl", "http://127.0.0.1:9999/");
        testOptions.put("command", "pwd");
        ExploitMode.initModel(testOptions);

        assertEquals("command", JmxDataModel.exploitModeName);
        assertEquals("127.0.0.1:23333", JmxDataModel.targetUrl);
        assertEquals("http://127.0.0.1:9999/", JmxDataModel.installUrl);
        assertEquals("pwd", JmxDataModel.command);
    }
}