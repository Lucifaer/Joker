package com.lucifaer.jokerframework.core.factory;

import com.lucifaer.jokerframework.data.ExploitDataModel.BaseExploitDataModel;
import com.lucifaer.jokerframework.modules.Exploit;
import com.lucifaer.jokerframework.utils.ClassUtil;
import org.springframework.beans.factory.FactoryBean;

import java.util.Map;

public class ExploitFactory implements FactoryBean {
    @Override
    public Object getObject() throws Exception {
        Map<String, Class> exploitMap = ClassUtil.getAllClassByInterface(Exploit.class);
        String exploitName = BaseExploitDataModel.exploitName;

        for (String className : exploitMap.keySet()) {
            String key = className.toLowerCase();
            if (key.equals(exploitName+"exploit")) {
                return exploitMap.get(className).newInstance();
            }
        }
        return null;
    }

    @Override
    public Class<?> getObjectType() {
        return Exploit.class;
    }
}
