package com.lucifaer.jokerframework.joker.core.dispatcher;

import com.lucifaer.jokerframework.joker.core.exploit.ExploitModel;
import com.lucifaer.jokerframework.joker.core.factory.BaseFactory;
import com.lucifaer.jokerframework.joker.core.filter.BaseFilter;
import com.lucifaer.jokerframework.joker.core.shell.ShellThrowableHandler;
import com.lucifaer.jokerframework.sdk.api.Exploit;
import com.lucifaer.jokerframework.sdk.context.ShellContext;
import org.springframework.stereotype.Component;

/**
 * @author Lucifaer
 * @version 3.0
 */
@Component
public class ExploitDispatcher extends BaseDispatcher<Exploit> {
    public ExploitDispatcher(ExploitModel model, BaseFactory<Exploit> factory, BaseFilter<Exploit> filter, ShellThrowableHandler shellThrowableHandler) {
        super(model, factory, filter, shellThrowableHandler);
    }

    @Override
    public Exploit dispatcher(ShellContext shellContext) {
        Exploit exploit = super.dispatcher(shellContext);
        filter.preCheck(exploit, shellContext);
        return exploit;
    }
}
