package com.lucifaer.jokerframework.joker.core.dispatcher;

import com.lucifaer.jokerframework.joker.core.factory.BaseFactory;
import com.lucifaer.jokerframework.joker.core.filter.BaseFilter;
import com.lucifaer.jokerframework.joker.core.model.TempExploitModel;
import com.lucifaer.jokerframework.joker.core.shell.ShellThrowableHandler;
import com.lucifaer.jokerframework.sdk.api.Exploit;
import com.lucifaer.jokerframework.sdk.context.ShellContext;
import com.lucifaer.jokerframework.sdk.model.ExploitModel;
import com.lucifaer.jokerframework.sdk.model.PluginModel;
import org.springframework.stereotype.Component;

/**
 * @author Lucifaer
 * @version 1.0.0.RELEASE
 * @since 2020/6/3
 */
@Component
public class ExploitDispatcher extends BaseDispatcher<ExploitModel> {
    public ExploitDispatcher(TempExploitModel model, BaseFactory<ExploitModel> factory, BaseFilter<ExploitModel> filter, ShellThrowableHandler shellThrowableHandler) {
        super(model, factory, filter, shellThrowableHandler);
    }

    @Override
    public Object dispatch(ShellContext shellContext) {
        Exploit exploit = null;
        PluginModel exploitModel = dispatcher(shellContext);
        try {
            exploit = (Exploit) exploitModel.getPlugin();
        } catch (Exception e) {
            e.printStackTrace();
        }
        return exploit;
    }
}
