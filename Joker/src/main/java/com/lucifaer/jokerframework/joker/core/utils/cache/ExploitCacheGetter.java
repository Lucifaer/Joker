package com.lucifaer.jokerframework.joker.core.utils.cache;

import com.lucifaer.jokerframework.joker.core.context.JokerContext;
import com.lucifaer.jokerframework.sdk.api.Exploit;
import org.springframework.stereotype.Component;

import java.util.Map;

/**
 * @author Lucifaer
 * @version 1.0.0.RELEASE
 * @since 2020/6/8
 */
@Component
public class ExploitCacheGetter {
    private final JokerContext jokerContext;

    public ExploitCacheGetter(JokerContext jokerContext) {
        this.jokerContext = jokerContext;
    }

    public Exploit getCachedExploit(String exploitName) {
        Map<String, Exploit> cachedExploitMap = jokerContext.getCachedExploitMap();
        if (cachedExploitMap != null && cachedExploitMap.containsKey(exploitName)) {
            return cachedExploitMap.get(exploitName);
        }
        return null;
    }

    public void addCachedExploit(Exploit exploit) {
        jokerContext.getCachedExploitMap().put(exploit.getExploitName(), exploit);
    }
}
